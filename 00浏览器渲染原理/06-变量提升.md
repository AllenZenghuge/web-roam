# 07 | 变量提升：JavaScript代码是按顺序执行的吗？

已经总结过了[执行上下文](https://github.com/SedationH/web-roam/blob/master/01%E5%89%8D%E7%AB%AF%E5%B0%8F%E5%86%8C%E5%AD%90%E9%A3%9F%E7%94%A8/03JS%E5%9F%BA%E7%A1%803.md#execution-context)

提一下重点内容

## 声明和赋值

![image-20200526115416730](http://picbed.sedationh.cn/image-20200526115416730.png)

![image-20200526115401092](http://picbed.sedationh.cn/image-20200526115401092.png)

## 执行上下文 execution context

**执行上下文是 JavaScript 执行一段代码时的运行环境**

一段代码的执行，JS要进行编译，创建执行上下文，再进入执行阶段

所谓变量提升并不是说变量和函数声明在源代码位置上的改变，而是JS引擎在编译完成后，可执行代码放入内存中，相应声明和赋值两种操作的分离，前者被“提升”到了开头，后者原本顺序

![image-20200526115326838](http://picbed.sedationh.cn/image-20200526115326838.png)

## 可执行代码

1. 当 JavaScript 执行全局代码的时候，会编译全局代码并创建全局执行上下文，而且在整个页面的生存周期内，全局执行上下文只有一份。
2. 当**调用**一个函数的时候，函数体内的代码会被编译，并创建函数执行上下文，一般情况下，函数执行结束之后，创建的函数执行上下文会被销毁。
3. 当使用 eval 函数的时候，eval 的代码也会被编译，并创建执行上下文。



## 环境变量的特点

在执行上下文中存在一个**变量环境的对象**（Viriable Environment），用来保存变量提升的操作。

1. 函数的所有形参 (如果是函数上下文)
   - 由名称和对应值组成的一个变量对象的属性被创建
   - 没有实参，属性值设为 undefined
2. 函数声明
   - 由名称和对应值（函数对象(function-object)）组成一个变量对象的属性被创建
   - 如果变量对象已经存在相同名称的属性，则完全替换这个属性
3. 变量声明
   - 由名称和对应值（undefined）组成一个变量对象的属性被创建；
   - 如果变量名称跟已经声明的**形式参数或函数相同，则变量声明不会干扰已经存在的这类属性**

## 总结

- JavaScript 代码执行过程中，需要先做**变量提升**，而之所以需要实现变量提升，是因为 JavaScript 代码在执行之前需要先**编译**。
- 在**编译阶段**，变量和函数会被存放到**变量环境**中，变量的默认值会被设置为 undefined；在代码**执行阶段**，JavaScript 引擎会从变量环境中去查找自定义的变量和函数。
- 如果在编译阶段，存在两个相同的函数，那么最终存放在变量环境中的是最后定义的那个，这是因为后定义的会覆盖掉之前定义的。

